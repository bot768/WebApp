import React, {useState, useEffect} from 'react';
import {Card, Row, Col, Typography} from 'antd';
import lunisolar from 'lunisolar';

const {Title, Text} = Typography;

const SolarTerms = () => {
    const [currentDate, setCurrentDate] = useState(null);
    const [Suggestion, setSuggestion] = useState(null);
    const [currentTerm, setCurrentTerm] = useState(null);
    const [error, setError] = useState(null);
    const solarTermAdvice = {
        "立春":
            "早春宜穿三明治式叠穿法（保暖内衣+针织开衫+防风外套），饮食侧重辛温升阳，推荐韭菜虾仁春卷配姜枣桂圆茶，居家正午开窗对流换气15分钟，出行可练习八段锦提升阳气，随身携带可触屏手套便于户外操作手机。",

        "雨水":
            "雨季穿搭首选防水面料冲锋衣搭配羊毛内胆，餐食以健脾祛湿为主，可煲五指毛桃茯苓鸡汤，家中衣柜悬挂除湿袋防止返潮，通勤建议选择防滑登山鞋并随身携带折叠伞，周末可进行轻量徒步亲近自然。",

        "惊蛰":
            "过渡季采用洋葱式穿衣法（衬衫+马甲+薄风衣），饮食宜清肝明目，凉拌枸杞芽搭配菊花决明子茶正当时，卧室开启除螨仪深度清洁寝具，晨练建议佩戴防花粉口罩进行户外太极拳，办公族可备护腕垫缓解键盘操作疲劳。",

        "春分":
            "昼夜温差大推荐穿可拆卸内胆夹克，时令菜选择香椿炒蛋佐荞麦面，家居注意调整窗帘遮光率保证睡眠质量，春游踏青建议携带可收纳野餐垫和防紫外线墨镜，过敏体质者出行前可服用抗组胺药物预防。",

        "清明":
            "雨季出行穿速干面料冲锋裤搭配防水登山靴，传统美食艾草青团宜搭配普洱消食解腻，家中玄关放置活性炭除湿盒，扫墓祭祖建议携带多功能求生哨和便携式雨衣，户外活动后及时更换干爽袜预防足癣。",

        "谷雨":
            "暮春穿搭选择透气亚麻衬衫配防晒冰袖，饮食推荐凉拌马齿苋搭配玉米须薏米茶，卧室更换防螨抗菌床品套件，农事活动建议穿戴防蚂蟥长筒袜，书房可摆放虎尾兰净化空气，雨季通勤包内常备速干毛巾。",

        "立夏":
            "初夏着装优选冰丝防晒衣配空顶遮阳帽，消暑饮品可自制三豆饮（绿豆+赤小豆+黑豆），居家使用藤编凉席搭配凝胶枕降温，正午时段尽量避免露天暴晒，户外工作者建议佩戴降温颈环，运动后及时补充电解质水。",

        "小满":
            "湿热气候穿竹纤维内衣增强透气性，时令推荐凉拌苦菊核桃仁配荷叶冬瓜茶，卧室使用除湿机保持45%-55%湿度，农田作业建议穿戴防割手套和护目镜，梅雨季通勤包内应备防霉除味炭包。",

        "芒种":
            "农忙时节穿速干T恤搭配透气护腰裤，体力消耗大宜食牛肉紫菜饭团配盐渍柠檬水，家中书房可摆放薄荷驱蚊绿植，收割作业建议使用防暑降温背心，办公室久坐族可备腰椎支撑靠垫。",

        "夏至":
            "盛夏穿搭选择银离子抑菌速干衣，消暑良品推荐杨梅荔枝饮搭配凉拌莼菜，西晒房间建议安装反射隔热窗帘，正午出行必备冰感降温毛巾和防晒袖套，驾驶车辆需备太阳镜防眩光。",

        "小暑":
            "酷暑期穿亚麻汉服搭配编织遮阳帽，养生推荐莲子百合粥配乌梅三豆饮，空调房使用加湿器防止黏膜干燥，户外工作者建议穿戴降温背心，随身携带迷你喷雾风扇和清凉油。",

        "大暑":
            "极端高温期穿冷感科技面料运动服，饮食宜冬瓜瑶柱汤搭配电解质泡腾片，卧室使用水循环降温床垫，外出必备医用速冷袋和防晒面罩，避免高温时段进行剧烈运动。",

        "立秋":
            "夏秋之交穿真丝睡衣搭配桑蚕丝眼罩，润燥推荐杏仁露配秋梨膏，衣柜开始悬挂雪松木驱虫块，登山徒步建议换装踝关节支撑鞋，敏感人群逐步减少冷饮摄入。",

        "处暑":
            "余热未消期穿棉麻混纺九分裤，养生推荐石斛炖水鸭配桂花酒酿圆子，家居开始检修供暖设备，晨跑建议佩戴心率监测手表，逐步增加南瓜、山药等黄色食物摄入。",

        "白露":
            "秋凉明显期穿灯芯绒外套配短靴，润肺宜食川贝炖雪梨配银耳羹，床铺更换磨毛保暖床品，夜跑建议穿戴反光运动装备，过敏性鼻炎患者注意佩戴口罩。",

        "秋分": "昼夜均分期穿针织开衫配丝巾，时令推荐板栗烧鸡搭配蜂蜜柚子茶，地暖启用前需专业清洗管道，骑行建议佩戴防风护目镜，开始增加坚果类食物储备。",

        "寒露": "深秋穿搭选羊绒大衣配皮质手套，温补推荐当归羊肉煲配桂圆茶，浴室铺设防滑硅胶地垫，登山建议携带可折叠坐垫，居家拖鞋更换为包跟保暖款。",

        "霜降":
            "初冬过渡期穿羽绒内胆冲锋衣，滋补推荐参鸡汤配黑芝麻糊，马桶加装恒温加热垫，晨练时间调整为日出后，汽车提前更换防冻玻璃水。",

        "立冬":
            "冬装首选气凝胶保暖内衣，高热饮食推荐姜母鸭配桂圆红枣茶，窗户密封条检查更换，滑雪建议穿戴电加热手套，开始制作滋补药酒。",

        "小雪":
            "湿冷期穿石墨烯发热马甲，驱寒推荐麻油鸡酒酿蛋，使用除雾镜防止卫浴镜面起雾，雪地行走建议穿戴冰爪鞋套，室内可摆放水培风信子调节湿度。",

        "大雪":
            "严寒期穿鹅绒派克大衣，高能量推荐牛肉火锅配高粱酒，使用智能温控电热毯，车辆必备防滑链，每日补充维生素D制剂。",

        "冬至":
            "数九寒天穿驼绒护膝配雪地靴，传统食补羊肉炉配八宝粥，使用空气炸锅制作滋补坚果，泡脚水温控制在45℃以下，早睡晚起顺应阳气闭藏。",

        "小寒":
            "深冬穿搭选貂绒帽配加热袜，御寒推荐十全大补汤配姜汁撞奶，使用超声波香薰机扩散肉桂精油，晨练推迟至阳光充足时段，汽车启动前预热发动机。",

        "大寒":
            "岁末穿电加热冲锋衣，温补推荐佛跳墙配黄酒，使用智能除霜冰箱储存年货，购置防滑老人鞋孝敬长辈，大扫除时佩戴防尘面罩，围炉煮茶注意通风防一氧化碳中毒。"
    }

    // 获取节气数据
    useEffect(() => {
        try {
            let solarTerm = null
            let now = new Date();
            while (true) {
                now = new Date(now.setDate(now.getDate() - 1));
                solarTerm = lunisolar(now).solarTerm?.toString()
                if (solarTerm != null) {
                    break;
                }
            }
            setCurrentTerm(solarTerm);
            setSuggestion(solarTermAdvice[solarTerm])
            setCurrentDate(new Date().toLocaleDateString('zh-CN'))
        } catch (err) {
            setError(err.message || '获取节气信息失败');
        }
    }, []);

    // 格式化当前日期
    const formatDate = (date) => {
        return date.toLocaleDateString('zh-CN', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    };
    return (
        <Card bodyStyle={{ padding: 16 }}>
            <Row gutter={[16, 16]}>
                <Col span={24}>
                    <Row gutter={16}>
                        <Col>
                            <Text strong>日期：</Text>
                            <Text>{currentDate}</Text>
                        </Col>
                        <Col>
                            <Text strong>节气：</Text>
                            <Text type="secondary">{currentTerm}</Text>
                        </Col>
                    </Row>
                </Col>
                <Col span={24}>
                    <Text
                        style={{
                            display: 'inline-block',
                            whiteSpace: 'pre-line',
                            wordBreak: 'break-word',
                            lineHeight: 1.6,
                            width: '100%'
                        }}
                    >
                        <Text strong>建议：</Text>
                        {Suggestion}
                    </Text>
                </Col>
            </Row>
        </Card>
    );
};

export default SolarTerms;